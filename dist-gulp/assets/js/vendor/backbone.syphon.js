!function(e,t){if("function"==typeof define&&define.amd)define(["underscore","backbone","jquery"],function(e,r,n){return t(e,r,n)});else if("undefined"!=typeof exports){var r=require("underscore"),n=require("backbone"),i=require("jquery");module.exports=t(r,n,i)}else t(e._,e.Backbone,e.jQuery)}(this,function(e,t,r){"use strict";var n=t.Syphon,i=t.Syphon={};i.VERSION="0.6.0",i.noConflict=function(){return t.Syphon=n,this},i.ignoredTypes=["button","submit","reset","fieldset"],i.serialize=function(t,n){var i={},o=a(n),d=s(t,o);return e.each(d,function(e){var t=r(e),n=u(t),s=o.keyExtractors.get(n),a=s(t),d=o.inputReaders.get(n),p=d(t),f=o.keyAssignmentValidators.get(n);if(f(t,a,p)){var y=o.keySplitter(a);i=c(i,y,p)}}),i},i.deserialize=function(t,n,i){var o=a(i),c=s(t,o),p=d(o,n);e.each(c,function(e){var t=r(e),n=u(t),i=o.keyExtractors.get(n),s=i(t),a=o.inputWriters.get(n),c=p[s];a(t,c)})};var s=function(t,n){var i=o(t);return i=e.reject(i,function(t){var i,s=u(t),o=n.keyExtractors.get(s),a=o(r(t)),c=e.find(n.ignoredTypes,function(e){return e===s||r(t).is(e)}),d=e.include(n.include,a),p=e.include(n.exclude,a);return i=d?!1:n.include?!0:p||c})},u=function(e){var t,n=r(e),i=n[0].tagName,s=i;return"input"===i.toLowerCase()&&(t=n.attr("type"),s=t?t:"text"),s.toLowerCase()},o=function(t){return e.isUndefined(t.$el)?r(t).children(":input"):t.$(":input")},a=function(t){var r=e.clone(t)||{};return r.ignoredTypes=e.clone(i.ignoredTypes),r.inputReaders=r.inputReaders||i.InputReaders,r.inputWriters=r.inputWriters||i.InputWriters,r.keyExtractors=r.keyExtractors||i.KeyExtractors,r.keySplitter=r.keySplitter||i.KeySplitter,r.keyJoiner=r.keyJoiner||i.KeyJoiner,r.keyAssignmentValidators=r.keyAssignmentValidators||i.KeyAssignmentValidators,r},c=function(t,r,n){if(!r)return t;var i=r.shift();return t[i]||(t[i]=e.isArray(i)?[]:{}),0===r.length&&(e.isArray(t[i])?t[i].push(n):t[i]=n),r.length>0&&c(t[i],r,n),t},d=function(t,r,n){var i={};return e.each(r,function(r,s){var u={};n&&(s=t.keyJoiner(n,s)),e.isArray(r)?(s+="[]",u[s]=r):e.isObject(r)?u=d(t,r,s):u[s]=r,e.extend(i,u)}),i},p=i.TypeRegistry=function(){this.registeredTypes={}};p.extend=t.Model.extend,e.extend(p.prototype,{get:function(t){return e.has(this.registeredTypes,t)?this.registeredTypes[t]:this.registeredTypes["default"]},register:function(e,t){this.registeredTypes[e]=t},registerDefault:function(e){this.registeredTypes["default"]=e},unregister:function(t){e.has(this.registeredTypes,t)&&delete this.registeredTypes[t]}});var f=i.KeyExtractorSet=p.extend(),y=i.KeyExtractors=new f;y.registerDefault(function(e){return e.prop("name")||""});var l=i.InputReaderSet=p.extend(),g=i.InputReaders=new l;g.registerDefault(function(e){return e.val()}),g.register("checkbox",function(e){return e.prop("indeterminate")?null:e.prop("checked")});var h=i.InputWriterSet=p.extend(),k=i.InputWriters=new h;k.registerDefault(function(e,t){e.val(t)}),k.register("checkbox",function(e,t){null===t?e.prop("indeterminate",!0):e.prop("checked",t)}),k.register("radio",function(e,t){e.prop("checked",e.val()===t.toString())});var v=i.KeyAssignmentValidatorSet=p.extend(),x=i.KeyAssignmentValidators=new v;return x.registerDefault(function(){return!0}),x.register("radio",function(e,t,r){return e.prop("checked")}),i.KeySplitter=function(e){var t,r=e.match(/[^\[\]]+/g);return e.length>1&&e.indexOf("[]")===e.length-2&&(t=r.pop(),r.push([t])),r},i.KeyJoiner=function(e,t){return e+"["+t+"]"},t.Syphon});